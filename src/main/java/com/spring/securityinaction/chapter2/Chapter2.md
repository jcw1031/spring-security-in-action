# 2. Hello! Spring Security

> Spring Security의 기본 구성 애플리케이션이 어떻게 동작하는지 확인하고
> 이 기본 구성에 속한 요소와 그 목적을 알아보자.

## 01. 가장 간단한 예제
`com.spring.securityinaction.chapter2` 경로의 `HelloController`는
하나의 엔드포인트를 갖는 매우 간단한 예제 `Controller`이다.

'http://localhost:8080/hello' 호출 시, 상태 코드가 `401` Unauthorized이다.
인증을 위한 올바른 자격 증명을 제공하지 않았기 때문이다. -> 기본적으로 스프링 시큐리티는
기본 사용자 이름(user)과 제공된 암호(Application을 실행하면 임의의 security password가 주어진다.)를 사용할 것으로 예상한다.

<br/>

#### 올바른 자격 증명을 지정하여 호출
```text
curl -u user:[비밀번호] http://localhost:8080/hello
```
이렇게 올바른 자격 증명을 보내면 응답이 잘 온다.

## 02. 기본 구성이란?
이 절에서는 전체 아키텍처에서 인증과 권한 부여를 참여하는 데 참여하는 주 구성 요소에 대해 논의한다.
이러한 사전 구성된 요소를 애플리케이션의 필요에 맞게 재정의해야 하기 때문이다.

### 기본적인 구성

아래는 스프링 시큐리티 아키텍처의 주 구성 요소와 이들 간의 관계를 나타낸 그림이다.

!!! 사진 !!!

- 인증 필터는 인증 요청을 인증 관리자에 위임하고 응답을 바탕으로 보안 컨텍스트를 구성한다.
- 인증 관리자는 인증 공급자를 이용해 인증을 처리한다.
- 인증 공급자는 인증 논리를 구현한다.
- 인증 공급자는 사용자 관리 책임을 구현하는 사요자 세부 정보 서비스를 인증 논리에 이용한다.
- 인증 공급자는 암호 관리를 구현하는 암호 인코더를 인증 논리에 이용한다.
- 보안 컨텍스트는 인증 프로세스 후 인증 데이터를 유지한다.

##### 자동으로 구성되는 빈
- `UserDetailsService`
- `PasswordEncoder`

인증 공급자가 이러한 빈을 이요해 사용자를 찾고 암호를 확인하는 것이다.

### 인증에 필요한 자격 증명을 제공하는 방법
사용자에 관한 세부 정보는 스프링 시큐리티로 `UserDetailsService` 계약을 구현하는
객체가 관리한다. 방금 예제는 스프링 부트가 제공하는 기본 구현을 사용했던 것이다.
이 기본 구현은 개념 증명의 역할을 하고 종속성이 작동하는 것을 확인해준다.

`PasswordEncoder`는 암호를 인코딩하고, 암호가 기존 인코딩과 일치하는지 확인하는 역할을 한다.

> HTTP Basic 인증은 자격 증명의 기밀성을 보장하지 않는다.

`AuthenticationProvider`는 인증 논리를 정의하고 사용자와 암호의 관리를 위임한다.
기본 구현은 `UserDetailsService` 및 `PasswordEncoder`에 제공된 기본 구현을 이용한다.